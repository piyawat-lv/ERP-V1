<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  </head>
  <body>
    <div class="collection">
      <a href="#" class="collection-item" onclick="event.preventDefault(); loadPage('ItemMaster_UI');">Item Master</a>
      <a href="#" class="collection-item" onclick="event.preventDefault(); loadPage('Wms_UI');">Warehouse (WMS)</a>
      <a href="#" class="collection-item" onclick="event.preventDefault(); loadPage('Bom_UI');">BOM Management</a>
      <a href="#" class="collection-item" onclick="event.preventDefault(); loadPage('Mrp_UI');">MRP Runner</a>
      <a href="#" class="collection-item" onclick="event.preventDefault(); loadPage('Mes_UI');">WIP Jobs</a>
      <div class="divider"></div>
      <a href="#" class="collection-item" onclick="event.preventDefault(); loadPage('InventoryReport_UI');"><b>Report:</b> Inventory History</a>
    </div>

    <script>
      function loadPage(pageName) {
        google.script.run
          .withSuccessHandler(function(html) {
            // This function is intended to be called from a main page that has a content div
            // For now, this sidebar is standalone. A full implementation would load the content into a main view.
            // For example: document.getElementById('content-display').innerHTML = html;
            console.log(`Request to load ${pageName} was sent.`);
          })
          .include(pageName);
      }
    </script>
  </body>
</html>
<li class="nav-item">
  <a href="#" class="nav-link" onclick="loadPage('user_management')">
    <span class="material-icons">manage_accounts</span>
    User Management
  </a>
</li>

<hr style="border-top: 1px solid #eee; margin: 10px 0;">

<li class="nav-item">
  <a href="#" class="nav-link" onclick="logoutSystem()" style="color: #d32f2f;">
    <span class="material-icons">logout</span>
    Logout
  </a>
</li>

<script>
  // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Logout (‡πÉ‡∏™‡πà‡πÑ‡∏ß‡πâ‡πÉ‡∏ô tag <script> ‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å)
  function logoutSystem() {
    if(confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
      // 1. ‡∏•‡∏ö Token ‡∏ó‡∏µ‡πà‡∏ù‡∏±‡πà‡∏á Client (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ)
      localStorage.removeItem('userToken');
      localStorage.removeItem('userData');
      
      // 2. ‡∏™‡∏±‡πà‡∏á Server ‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏•‡∏≤‡∏¢ Session (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ) ‡πÅ‡∏•‡πâ‡∏ß Reload ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ Login
      google.script.run
        .withSuccessHandler(function() {
           window.top.location = google.script.run.getUrl(); // Reload ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
        })
        .logoutServerSide(); // ‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏ó‡∏µ‡πà Backend
    }
  }
</script>
<div class="divider"></div>
<a href="#" class="collection-item" onclick="event.preventDefault(); loadPage('UserManagement_UI');">üë• Manage Users (Admin)</a>
<a href="#" class="collection-item" onclick="event.preventDefault(); loadPage('ChangePassword_UI');">üîí Change Password</a>